<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Checkout - LUNAIRE</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    .font-playfair { font-family: 'Playfair Display', serif; }
    .font-inter { font-family: 'Inter', sans-serif; }
    .font-lunaire { font-family: 'Playfair Display', serif; font-weight: 500; }
    .dropdown-menu { transform: translateX(-100%); transition: transform 0.3s ease-in-out; }
    .dropdown-menu.open { transform: translateX(0); }
    .overlay { opacity: 0; visibility: hidden; transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out; }
    .overlay.open { opacity: 1; visibility: visible; }
    /* small styles for qty controls */
    .qty-btn { width: 32px; height: 32px; display:inline-flex; align-items:center; justify-content:center; border-radius:6px; border:1px solid #e5e7eb; cursor:pointer; }
    .qty-input { width: 56px; text-align:center; border:1px solid #e5e7eb; border-radius:6px; padding:6px; }
  </style>
</head>

<body class="bg-gray-50 font-inter">

  <!-- Header -->
   <header class="relative bg-white border-b border-gray-200 z-50">
        <div class="flex items-center px-4 md:px-6 py-4">
            <!-- Menu Toggle -->
            <button id="menuToggle" class="flex flex-col space-y-1.5 p-2 md:p-3 hover:bg-gray-100 rounded-md transition-colors mr-3 md:mr-6">
                <span class="w-6 md:w-7 h-0.5 bg-black transition-all"></span>
                <span class="w-6 md:w-7 h-0.5 bg-black transition-all"></span>
                <span class="w-6 md:w-7 h-0.5 bg-black transition-all"></span>
            </button>

            <!-- Logo -->
         <a href="Homepage.html" class="flex-1">
  <h1 class="font-lunaire text-3xl md:text-4xl text-black tracking-wide cursor-pointer">LUNAIRE</h1>
</a>
            <!-- Search Bar (Hidden by default) -->
            <div id="searchBar" class="hidden absolute left-0 right-0 top-full bg-white px-4 py-3 border-b border-gray-200 md:relative md:flex-1 md:max-w-md md:mx-4 md:border-0 md:p-0">
                <div class="relative">
                    <input type="text" id="searchInput" placeholder="Search products..." class="w-full border border-gray-300 rounded-md px-4 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-black text-base">
                    <button id="clearSearch" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-black hidden">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Icons -->
            <div class="flex items-center space-x-2 md:space-x-4">
                <button id="searchToggle" class="p-2 hover:bg-gray-100 rounded-full transition-colors">
                    <i class="fas fa-search text-black text-lg md:text-xl"></i>
                </button>
                <button class="p-2 hover:bg-gray-100 rounded-full transition-colors">
                    <i class="fas fa-user text-black text-lg md:text-xl"></i>
                </button>
                <button class="p-2 hover:bg-gray-100 rounded-full transition-colors relative">
                    <i class="fas fa-shopping-bag text-black text-lg md:text-xl"></i>
                    <span class="absolute -top-1 -right-1 bg-black text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">0</span>
                </button>
            </div>
        </div>
    </header>
    <!-- Overlay -->
    <div id="overlay" class="overlay fixed inset-0 bg-black bg-opacity-50 z-40"></div>

    <!-- Dropdown Menu -->
    <nav id="dropdownMenu" class="dropdown-menu fixed left-0 top-0 h-full w-80 bg-white shadow-2xl z-50 overflow-y-auto">
        <div class="p-6">
            <div class="mb-8">
                <h2 class="font-lunaire text-xl text-black tracking-wide">LUNAIRE</h2>
            </div>
            <ul class="space-y-4">
                <li>
                    <a href="Homepage.html" class="block text-gray-700 hover:text-black font-medium transition-colors">Home</a>
                </li>
                <li>
                    <button class="flex justify-between items-center w-full text-gray-700 hover:text-black font-medium transition-colors submenu-btn">
                        Shop <span class="transform transition-transform">▾</span>
                    </button>
                    <ul class="ml-4 mt-2 space-y-2 hidden submenu">
                        <li><a href="AfterShp.html" class="block text-gray-500 hover:text-black transition-colors">Collection Name</a></li>
                    </ul>
                </li>
                <li>
                    <button class="flex justify-between items-center w-full text-gray-700 hover:text-black font-medium transition-colors submenu-btn">
                        My Account <span class="transform transition-transform">▾</span>
                    </button>
                    <ul class="ml-4 mt-2 space-y-2 hidden submenu">
                        <li><a href="login.html" class="block text-gray-500 hover:text-black transition-colors">Login</a></li>
                        <li><a href="signup.html" class="block text-gray-500 hover:text-black transition-colors">Sign-up</a></li>
                        <li><a href="#" class="block text-gray-500 hover:text-black transition-colors">Orders</a></li>
                    </ul>
                </li>
                <li>
                    <button class="flex justify-between items-center w-full text-gray-700 hover:text-black font-medium transition-colors submenu-btn">
                        About Us <span class="transform transition-transform">▾</span>
                    </button>
                    <ul class="ml-4 mt-2 space-y-2 hidden submenu">
                        <li><a href="#" id="aboutLink" class="block text-gray-500 hover:text-black transition-colors">Our Story</a></li>
                    </ul>
                </li>
                <li>
                    <button class="flex justify-between items-center w-full text-gray-700 hover:text-black font-medium transition-colors submenu-btn">
                        Catalogue <span class="transform transition-transform">▾</span>
                    </button>
                    <ul class="ml-4 mt-2 space-y-2 hidden submenu">
                        <li><a href="Aftershp.html" class="block text-gray-500 hover:text-black transition-colors">Collections</a></li>
                    </ul>
                </li>
                <li>
                    <button class="flex justify-between items-center w-full text-gray-700 hover:text-black font-medium transition-colors submenu-btn">
                        FAQs <span class="transform transition-transform">▾</span>
                    </button>
                    <ul class="ml-4 mt-2 space-y-2 hidden submenu">
                        <li><a href="faq.html" class="text-black underline hover:text-gray-700">Visit FAQs</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>
  <!-- Main Checkout (two-column) -->
  <main class="max-w-6xl mx-auto px-6 py-10 grid grid-cols-1 lg:grid-cols-2 gap-10">
    <!-- Left: Checkout Form -->
    <section>
      <h2 class="text-3xl font-playfair font-bold mb-6">Contact</h2>

      <form id="checkoutForm" class="space-y-6" novalidate>
        <!-- Email -->
        <div>
          <label class="block text-sm font-medium mb-2">Email</label>
          <input id="email" name="email" required type="email" placeholder="your@email.com"
            class="w-full border border-gray-300 rounded-md px-4 py-3 focus:ring-2 focus:ring-black focus:outline-none">
          <div class="flex items-center mt-2">
            <input type="checkbox" id="news" class="mr-2">
            <label for="news" class="text-sm text-gray-700">Email me with news and offers</label>
          </div>
        </div>

        <h2 class="text-3xl font-playfair font-bold mt-10 mb-6">Delivery</h2>

        <!-- City (primary, validated like screenshot) -->
        <div>
          <label class="block text-sm font-medium mb-2">City</label>
          <select id="primaryCity" required
            class="w-full border border-gray-300 rounded-md px-4 py-3 focus:ring-2 focus:ring-black focus:outline-none">
            <option value="">Select city from dropdown</option>
            <option>Karachi</option>
            <option>Lahore</option>
            <option>Islamabad</option>
            <option>Rawalpindi</option>
            <option>Faisalabad</option>
            <option>Multan</option>
            <option>Hyderabad</option>
          </select>
          <p id="cityError" class="text-red-500 text-sm mt-1 hidden">Please select city from dropdown</p>
        </div>

        <!-- Country (read-only) -->
        <div>
          <label class="block text-sm font-medium mb-2">Country/Region</label>
          <input type="text" readonly value="Pakistan"
            class="w-full border border-gray-300 rounded-md px-4 py-3 bg-gray-100 text-gray-600">
        </div>

        <!-- Name -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-2">First name</label>
            <input id="firstName" name="firstName" required type="text" placeholder="First name"
              class="w-full border border-gray-300 rounded-md px-4 py-3 focus:ring-2 focus:ring-black focus:outline-none">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Last name</label>
            <input id="lastName" name="lastName" required type="text" placeholder="Last name"
              class="w-full border border-gray-300 rounded-md px-4 py-3 focus:ring-2 focus:ring-black focus:outline-none">
          </div>
        </div>

        <!-- Address -->
        <div>
          <label class="block text-sm font-medium mb-2">Address</label>
          <input id="address" name="address" required type="text" placeholder="Address"
            class="w-full border border-gray-300 rounded-md px-4 py-3 focus:ring-2 focus:ring-black focus:outline-none">
        </div>

        <!-- City + Postal (secondary city dropdown kept for UI parity) -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-2">City</label>
            <select id="secondaryCity" required
              class="w-full border border-gray-300 rounded-md px-4 py-3 focus:ring-2 focus:ring-black focus:outline-none">
              <option value="">Select city from city dropdown</option>
              <option>Karachi</option>
              <option>Lahore</option>
              <option>Islamabad</option>
              <option>Multan</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Postal code (optional)</label>
            <input id="postal" type="text" placeholder="Postal code"
              class="w-full border border-gray-300 rounded-md px-4 py-3 focus:ring-2 focus:ring-black focus:outline-none">
          </div>
        </div>

        <!-- Phone -->
        <div>
          <label class="block text-sm font-medium mb-2">Phone</label>
          <input id="phone" name="phone" required type="tel" placeholder="+92 XXX XXXXXXX"
            class="w-full border border-gray-300 rounded-md px-4 py-3 focus:ring-2 focus:ring-black focus:outline-none">
        </div>

        <!-- Save info -->
        <div class="flex items-center">
          <input type="checkbox" id="saveInfo" class="mr-2">
          <label for="saveInfo" class="text-sm">Save this information for next time</label>
        </div>

        <!-- Place order button -->
        <div class="flex gap-4">
          <button id="placeOrderBtn" type="submit" class="flex-1 bg-black text-white py-3 rounded-lg font-semibold hover:bg-gray-800 transition">
            Place Order
          </button>

          <button type="button" id="clearCartBtn" class="flex-1 bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700 transition">
            Clear Cart
          </button>
        </div>
      </form>
    </section>

    <!-- Right: Order Summary -->
    <section>
      <div class="bg-white rounded-lg shadow p-6">
        <h2 class="text-2xl font-playfair font-bold mb-6">Order Summary</h2>

        <!-- Cart Items -->
        <div id="cartItems" class="space-y-4 mb-6">
          <!-- Items will be dynamically inserted here -->
          <div class="text-center text-gray-500 py-8">
            <i class="fas fa-shopping-bag text-4xl mb-4"></i>
            <p>Your cart is empty</p>
          </div>
        </div>

        <!-- Subtotal, Shipping, Total -->
        <div class="border-t border-gray-200 pt-4 space-y-2">
          <div class="flex justify-between">
            <span>Subtotal</span>
            <span id="subtotal">Rs. 0</span>
          </div>
          <div class="flex justify-between">
            <span>Shipping</span>
            <span id="shipping">Rs. 0</span>
          </div>
          <div class="flex justify-between text-lg font-bold border-t border-gray-200 pt-4">
            <span>Total</span>
            <span id="total">Rs. 0</span>
          </div>
        </div>
      </div>
    </section>
  </main>

   <!-- FOOTER PLACEHOLDER -->
<div id="footer"></div>

  <!-- Load universal-cart.js BEFORE other scripts so functions are available -->
  <script src="universal-cart.js"></script>
  <script>
    // Menu toggle functionality
    const menuToggle = document.getElementById("menuToggle");
    const dropdownMenu = document.getElementById("dropdownMenu");
    const overlay = document.getElementById("overlay");
    const searchToggle = document.getElementById("searchToggle");
    const searchBar = document.getElementById("searchBar");

    // Menu toggle
    if (menuToggle && dropdownMenu && overlay) {
      menuToggle.addEventListener("click", () => {
        dropdownMenu.classList.toggle("open");
        overlay.classList.toggle("open");
      });

      overlay.addEventListener("click", () => {
        dropdownMenu.classList.remove("open");
        overlay.classList.remove("open");
      });
    }

    // Submenu toggle
    document.querySelectorAll(".submenu-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        const submenu = btn.nextElementSibling;
        submenu.classList.toggle("hidden");
        btn.querySelector("span").classList.toggle("rotate-180");
      });
    });

    // Search bar toggle
    if (searchToggle && searchBar) {
      searchToggle.addEventListener("click", () => {
        searchBar.classList.toggle("hidden");
      });
    }

    function loadCartItems() {
      const cartItemsContainer = document.getElementById('cartItems');
      const subtotalElement = document.getElementById('subtotal');
      const shippingElement = document.getElementById('shipping');
      const totalElement = document.getElementById('total');
      const headerCartCount = document.querySelector('.fa-shopping-bag + span');

      console.log("[v0] Loading cart items for checkout:", cartItems);
      
      if (cartItems.length === 0) {
        cartItemsContainer.innerHTML = `
          <div class="text-center text-gray-500 py-8">
            <i class="fas fa-shopping-bag text-4xl mb-4"></i>
            <p>Your cart is empty</p>
          </div>
        `;
        subtotalElement.textContent = 'Rs. 0';
        shippingElement.textContent = 'Rs. 0';
        totalElement.textContent = 'Rs. 0';
        if (headerCartCount) headerCartCount.textContent = '0';
        return;
      }

      let subtotal = 0;
      let html = '';

      cartItems.forEach((item, index) => {
        const itemTotal = (item.price || 0) * (item.quantity || 1);
        subtotal += itemTotal;

        html += `
          <div class="flex items-center space-x-4 border-b pb-4">
            <img src="${item.img || 'placeholder.jpg'}" alt="${item.name}" class="w-16 h-16 object-cover rounded">
            <div class="flex-1">
              <h3 class="font-medium">${item.name}</h3>
              <p class="text-sm text-gray-600">Size: ${item.size || 'WS-25'}</p>
              <p class="text-sm text-gray-600">Rs. ${(item.price || 0).toLocaleString()}</p>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-sm">Qty: ${item.quantity || 1}</span>
            </div>
          </div>
        `;
      });

      cartItemsContainer.innerHTML = html;
      
      const shipping = subtotal > 0 ? 250 : 0;
      const total = subtotal + shipping;

      subtotalElement.textContent = `Rs. ${subtotal.toLocaleString()}`;
      shippingElement.textContent = `Rs. ${shipping.toLocaleString()}`;
      totalElement.textContent = `Rs. ${total.toLocaleString()}`;
      
      const totalItems = cartItems.reduce((sum, item) => sum + (item.quantity || 1), 0);
      if (headerCartCount) headerCartCount.textContent = totalItems.toString();
    }

    document.addEventListener('DOMContentLoaded', function() {
      const checkoutForm = document.getElementById('checkoutForm');
      const primaryCity = document.getElementById('primaryCity');
      const cityError = document.getElementById('cityError');
      const clearCartBtn = document.getElementById('clearCartBtn');
      const placeOrderBtn = document.getElementById('placeOrderBtn');

      // Validate city dropdown
      if (primaryCity) {
        primaryCity.addEventListener('change', function() {
          if (this.value) {
            cityError.classList.add('hidden');
          }
        });
      }

      // Form submission
      if (checkoutForm) {
        checkoutForm.addEventListener('submit', function(e) {
          e.preventDefault();
          
          // Validate city
          if (!primaryCity.value) {
            cityError.classList.remove('hidden');
            primaryCity.focus();
            return;
          }

          // Validate other required fields
          const requiredFields = ['email', 'firstName', 'lastName', 'address', 'phone'];
          let isValid = true;
          
          requiredFields.forEach(field => {
            const element = document.getElementById(field);
            if (element && !element.value.trim()) {
              isValid = false;
              element.classList.add('border-red-500');
            } else if (element) {
              element.classList.remove('border-red-500');
            }
          });

          if (!isValid) {
            alert('Please fill in all required fields.');
            return;
          }

          // If validation passes
          alert('Order placed successfully!');
          clearCart();
          // Redirect to home
          window.location.href = 'Homepage.html';
        });
      }

      // Clear cart button
      if (clearCartBtn) {
        clearCartBtn.addEventListener('click', function() {
          if (confirm('Are you sure you want to clear your cart?')) {
            clearCart();
            alert('Cart cleared successfully!');
            loadCartItems();
          }
        });
      }

      setTimeout(() => {
        loadCartItems();
      }, 50);
    });

    fetch("footer.html")
    .then(response => response.text())
    .then(data => {
      document.getElementById("footer").innerHTML = data;
    })
    .catch(err => console.error("Failed to load footer:", err));

  </script>

  <script src="about.js"></script>

</body>
</html>
